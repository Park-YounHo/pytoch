{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyPAccSoFnJmAoedMoT97YL1"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"5e22ae5ba43246d383549af1f3b7ccd6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b96af2bf93044b4e898221727bec9201","IPY_MODEL_7586b4e207244e04b0596324c23a2b2b","IPY_MODEL_5b99c208fc0c47a4a9d46b7156781cd4"],"layout":"IPY_MODEL_272c3e26fc12485db7060a2af0b957b0"}},"b96af2bf93044b4e898221727bec9201":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1aad53bdbaec414b9a20fe0f7d945897","placeholder":"​","style":"IPY_MODEL_a67bf4b8365749f294abd0b3938f0cf9","value":"100%"}},"7586b4e207244e04b0596324c23a2b2b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_43483b05be71462d8ef1464330e4ff74","max":26421880,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6d06c96547cd42c790e5a5fe5b8f6aeb","value":26421880}},"5b99c208fc0c47a4a9d46b7156781cd4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8ce9286a335247ceb70742f3899d99a5","placeholder":"​","style":"IPY_MODEL_c99bef81b2604591ac9cadba7e82e8b6","value":" 26421880/26421880 [00:01&lt;00:00, 28232492.30it/s]"}},"272c3e26fc12485db7060a2af0b957b0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1aad53bdbaec414b9a20fe0f7d945897":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a67bf4b8365749f294abd0b3938f0cf9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"43483b05be71462d8ef1464330e4ff74":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6d06c96547cd42c790e5a5fe5b8f6aeb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8ce9286a335247ceb70742f3899d99a5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c99bef81b2604591ac9cadba7e82e8b6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bacec2a6fdb3479f93c12f9ea0edcb14":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f7b3fccd902d41f1baa131cf75468227","IPY_MODEL_5cb83766b798492982b1840380751471","IPY_MODEL_2d2552c3ee9f45a48b4e4ac876054ecd"],"layout":"IPY_MODEL_6c3d57cfb99e4f42a98c0ed97077f17e"}},"f7b3fccd902d41f1baa131cf75468227":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_faa86263494747d790390cebb0bc1314","placeholder":"​","style":"IPY_MODEL_8fe87ff997bd46138b1ebdc0e9e2f7f3","value":"100%"}},"5cb83766b798492982b1840380751471":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_21ebffe7d03d4bf9969a799ffd2dec79","max":29515,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e7e738bdc1cf4e3c9c0c9c20a5f7ca44","value":29515}},"2d2552c3ee9f45a48b4e4ac876054ecd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_97bc3d95fa2a4b45ba029cf6933fce49","placeholder":"​","style":"IPY_MODEL_7746cf68dff64254b728ba2d2ea4414c","value":" 29515/29515 [00:00&lt;00:00, 336175.33it/s]"}},"6c3d57cfb99e4f42a98c0ed97077f17e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"faa86263494747d790390cebb0bc1314":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8fe87ff997bd46138b1ebdc0e9e2f7f3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"21ebffe7d03d4bf9969a799ffd2dec79":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e7e738bdc1cf4e3c9c0c9c20a5f7ca44":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"97bc3d95fa2a4b45ba029cf6933fce49":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7746cf68dff64254b728ba2d2ea4414c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"caa685729a0c41a6ad4bf4fe921dedbd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_019b7416adcc4e5c8ada2818ad34f854","IPY_MODEL_ebbea0d6f36f4fa4b4ed541e9ebf4f25","IPY_MODEL_3f19e6a30c8b4e878146d223a48718b8"],"layout":"IPY_MODEL_85e126d26e074222966278d9c8813228"}},"019b7416adcc4e5c8ada2818ad34f854":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c6486adad144f56b55f64c051f0219b","placeholder":"​","style":"IPY_MODEL_0b82fe3d25b94b9c98a72c63949de99b","value":"100%"}},"ebbea0d6f36f4fa4b4ed541e9ebf4f25":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_447a15be361d4bd3b03164835c1b8b6a","max":4422102,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9451ed5da1e842efbb59e3efe3273182","value":4422102}},"3f19e6a30c8b4e878146d223a48718b8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4e628023ba354389b0374a8411916f8a","placeholder":"​","style":"IPY_MODEL_87993ec9515542979a43e66cc1b2cce6","value":" 4422102/4422102 [00:00&lt;00:00, 4116855.80it/s]"}},"85e126d26e074222966278d9c8813228":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8c6486adad144f56b55f64c051f0219b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0b82fe3d25b94b9c98a72c63949de99b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"447a15be361d4bd3b03164835c1b8b6a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9451ed5da1e842efbb59e3efe3273182":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4e628023ba354389b0374a8411916f8a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"87993ec9515542979a43e66cc1b2cce6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b261b61de9f34280982cc924e0c5a62e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_922db6761d974b87b7253b7a4191d60b","IPY_MODEL_f1363118d0204435bdb87186e633fc98","IPY_MODEL_9eb333c101614b5a8b98a34d47509563"],"layout":"IPY_MODEL_c41d5a45e186455ea68e009245f50e0c"}},"922db6761d974b87b7253b7a4191d60b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c48edc96bcf4406f8c48a29121d23ced","placeholder":"​","style":"IPY_MODEL_5b8c6e62c6ba479b9f4d0bf60139aa75","value":"100%"}},"f1363118d0204435bdb87186e633fc98":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_463cbd88ad564812a16348b43139fef7","max":5148,"min":0,"orientation":"horizontal","style":"IPY_MODEL_78f6535e72d145949f0c9dded2d07d9e","value":5148}},"9eb333c101614b5a8b98a34d47509563":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aff3c1fb1b9d4f32b40c2d7b6317c38e","placeholder":"​","style":"IPY_MODEL_e54e6331f55a4aafa501edc12290db89","value":" 5148/5148 [00:00&lt;00:00, 98646.67it/s]"}},"c41d5a45e186455ea68e009245f50e0c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c48edc96bcf4406f8c48a29121d23ced":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b8c6e62c6ba479b9f4d0bf60139aa75":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"463cbd88ad564812a16348b43139fef7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"78f6535e72d145949f0c9dded2d07d9e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"aff3c1fb1b9d4f32b40c2d7b6317c38e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e54e6331f55a4aafa501edc12290db89":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1bcf7940909a4a659353451a51e9acb2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1d1d03272c834457af4998123a13e1ba","IPY_MODEL_c6cef582adac458c845e783a3edb3f70","IPY_MODEL_e46566b2c4ce4724b3d129ba540ba556"],"layout":"IPY_MODEL_232089716d2d4ecb99d41c610d7b8ae6"}},"1d1d03272c834457af4998123a13e1ba":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_858b29ed86a343e0a28152eecbb770bc","placeholder":"​","style":"IPY_MODEL_5b06b77a9a244175872d5c87249f49ae","value":"100%"}},"c6cef582adac458c845e783a3edb3f70":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3b940d8ba70342a592638c70dbb8e08b","max":553433881,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ac3de85019214e0185a187d92d51631b","value":553433881}},"e46566b2c4ce4724b3d129ba540ba556":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b20ddbe80efc4f9c8d44a1c098e8e0cf","placeholder":"​","style":"IPY_MODEL_464dc6fa6a2547298c65c1bd54d78343","value":" 528M/528M [00:05&lt;00:00, 78.7MB/s]"}},"232089716d2d4ecb99d41c610d7b8ae6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"858b29ed86a343e0a28152eecbb770bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b06b77a9a244175872d5c87249f49ae":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3b940d8ba70342a592638c70dbb8e08b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ac3de85019214e0185a187d92d51631b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b20ddbe80efc4f9c8d44a1c098e8e0cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"464dc6fa6a2547298c65c1bd54d78343":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["#0\n"],"metadata":{"id":"ns3yda4Nf8bP"}},{"cell_type":"code","execution_count":1,"metadata":{"id":"ZQcvBv2AfPGj","executionInfo":{"status":"ok","timestamp":1662429002873,"user_tz":-540,"elapsed":2819,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"outputs":[],"source":["import torch\n","from torch import nn\n","from torch.utils.data import DataLoader\n","from torchvision import datasets\n","from torchvision.transforms import ToTensor"]},{"cell_type":"code","source":["training_data = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=True,\n","    download=True,\n","    transform=ToTensor(),\n",")\n","test_data = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=False,\n","    download=True,\n","    transform=ToTensor(),\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":439,"referenced_widgets":["5e22ae5ba43246d383549af1f3b7ccd6","b96af2bf93044b4e898221727bec9201","7586b4e207244e04b0596324c23a2b2b","5b99c208fc0c47a4a9d46b7156781cd4","272c3e26fc12485db7060a2af0b957b0","1aad53bdbaec414b9a20fe0f7d945897","a67bf4b8365749f294abd0b3938f0cf9","43483b05be71462d8ef1464330e4ff74","6d06c96547cd42c790e5a5fe5b8f6aeb","8ce9286a335247ceb70742f3899d99a5","c99bef81b2604591ac9cadba7e82e8b6","bacec2a6fdb3479f93c12f9ea0edcb14","f7b3fccd902d41f1baa131cf75468227","5cb83766b798492982b1840380751471","2d2552c3ee9f45a48b4e4ac876054ecd","6c3d57cfb99e4f42a98c0ed97077f17e","faa86263494747d790390cebb0bc1314","8fe87ff997bd46138b1ebdc0e9e2f7f3","21ebffe7d03d4bf9969a799ffd2dec79","e7e738bdc1cf4e3c9c0c9c20a5f7ca44","97bc3d95fa2a4b45ba029cf6933fce49","7746cf68dff64254b728ba2d2ea4414c","caa685729a0c41a6ad4bf4fe921dedbd","019b7416adcc4e5c8ada2818ad34f854","ebbea0d6f36f4fa4b4ed541e9ebf4f25","3f19e6a30c8b4e878146d223a48718b8","85e126d26e074222966278d9c8813228","8c6486adad144f56b55f64c051f0219b","0b82fe3d25b94b9c98a72c63949de99b","447a15be361d4bd3b03164835c1b8b6a","9451ed5da1e842efbb59e3efe3273182","4e628023ba354389b0374a8411916f8a","87993ec9515542979a43e66cc1b2cce6","b261b61de9f34280982cc924e0c5a62e","922db6761d974b87b7253b7a4191d60b","f1363118d0204435bdb87186e633fc98","9eb333c101614b5a8b98a34d47509563","c41d5a45e186455ea68e009245f50e0c","c48edc96bcf4406f8c48a29121d23ced","5b8c6e62c6ba479b9f4d0bf60139aa75","463cbd88ad564812a16348b43139fef7","78f6535e72d145949f0c9dded2d07d9e","aff3c1fb1b9d4f32b40c2d7b6317c38e","e54e6331f55a4aafa501edc12290db89"]},"id":"OhY5N2DcfVVN","executionInfo":{"status":"ok","timestamp":1662429014522,"user_tz":-540,"elapsed":4979,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"c2052956-afdb-416b-fbc0-3e7867c5475b"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz to data/FashionMNIST/raw/train-images-idx3-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/26421880 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5e22ae5ba43246d383549af1f3b7ccd6"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting data/FashionMNIST/raw/train-images-idx3-ubyte.gz to data/FashionMNIST/raw\n","\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw/train-labels-idx1-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/29515 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bacec2a6fdb3479f93c12f9ea0edcb14"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting data/FashionMNIST/raw/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw\n","\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/4422102 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"caa685729a0c41a6ad4bf4fe921dedbd"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw\n","\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/5148 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b261b61de9f34280982cc924e0c5a62e"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Extracting data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw\n","\n"]}]},{"cell_type":"code","source":["batch_size = 64\n","train_dataloader = DataLoader(training_data, batch_size=batch_size)\n","test_dataloader = DataLoader(test_data, batch_size=batch_size)\n","\n","for X, y in test_dataloader:\n","    print(f\"Shape of X [N, C, H, W]: {X.shape}\")\n","    print(f\"Shape of y: {y.shape} {y.dtype}\")\n","    break"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jU2dhQPZfY30","executionInfo":{"status":"ok","timestamp":1662429026723,"user_tz":-540,"elapsed":307,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"d134a69b-4310-468b-b437-92ffd4dca1a2"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Shape of X [N, C, H, W]: torch.Size([64, 1, 28, 28])\n","Shape of y: torch.Size([64]) torch.int64\n"]}]},{"cell_type":"code","source":["device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n","print(f\"Using {device} device\")\n","\n","class NeuralNetwork(nn.Module):\n","    def __init__(self):\n","        super(NeuralNetwork, self).__init__()\n","        self.flatten = nn.Flatten()\n","        self.linear_relu_stack = nn.Sequential(\n","            nn.Linear(28*28, 512),\n","            nn.ReLU(),\n","            nn.Linear(512, 512),\n","            nn.ReLU(),\n","            nn.Linear(512, 10)\n","        )\n","\n","    def forward(self, x):\n","        x = self.flatten(x)\n","        logits = self.linear_relu_stack(x)\n","        return logits\n","\n","model = NeuralNetwork().to(device)\n","print(model)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_N5Fcii1fdr-","executionInfo":{"status":"ok","timestamp":1662429033111,"user_tz":-540,"elapsed":323,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"1de3d204-88d7-41bc-9f10-c278db2a7160"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["Using cpu device\n","NeuralNetwork(\n","  (flatten): Flatten(start_dim=1, end_dim=-1)\n","  (linear_relu_stack): Sequential(\n","    (0): Linear(in_features=784, out_features=512, bias=True)\n","    (1): ReLU()\n","    (2): Linear(in_features=512, out_features=512, bias=True)\n","    (3): ReLU()\n","    (4): Linear(in_features=512, out_features=10, bias=True)\n","  )\n",")\n"]}]},{"cell_type":"code","source":["loss_fn = nn.CrossEntropyLoss()\n","optimizer = torch.optim.SGD(model.parameters(), lr=1e-3)"],"metadata":{"id":"3mJjQKgzfgmI","executionInfo":{"status":"ok","timestamp":1662429040994,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["def train(dataloader, model, loss_fn, optimizer):\n","    size = len(dataloader.dataset)\n","    for batch, (X, y) in enumerate(dataloader):\n","        X, y = X.to(device), y.to(device)\n","\n","        pred = model(X)\n","        loss = loss_fn(pred, y)\n","\n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()\n","\n","        if batch % 100 == 0:\n","            loss, current = loss.item(), batch * len(X)\n","            print(f\"loss: {loss:>7f}  [{current:>5d}/{size:>5d}]\")"],"metadata":{"id":"E3mAdcXifiWx","executionInfo":{"status":"ok","timestamp":1662429053552,"user_tz":-540,"elapsed":309,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["def test(dataloader, model, loss_fn):\n","    size = len(dataloader.dataset)\n","    num_batches = len(dataloader)\n","    model.eval()\n","    test_loss, correct = 0, 0\n","    with torch.no_grad():\n","        for X, y in dataloader:\n","            X, y = X.to(device), y.to(device)\n","            pred = model(X)\n","            test_loss += loss_fn(pred, y).item()\n","            correct += (pred.argmax(1) == y).type(torch.float).sum().item()\n","    test_loss /= num_batches\n","    correct /= size\n","    print(f\"Test Error: \\n Accuracy: {(100*correct):>0.1f}%, Avg loss: {test_loss:>8f} \\n\")"],"metadata":{"id":"r_28n7NCflc9","executionInfo":{"status":"ok","timestamp":1662429061792,"user_tz":-540,"elapsed":290,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["epochs = 5\n","for t in range(epochs):\n","    print(f\"Epoch {t+1}\\n-------------------------------\")\n","    train(train_dataloader, model, loss_fn, optimizer)\n","    test(test_dataloader, model, loss_fn)\n","print(\"Done!\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fhEyuNOhfn6E","executionInfo":{"status":"ok","timestamp":1662429135976,"user_tz":-540,"elapsed":65175,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"4fdc5c18-33bf-4ed5-bc98-fae3b43e6d4b"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1\n","-------------------------------\n","loss: 2.288553  [    0/60000]\n","loss: 2.276831  [ 6400/60000]\n","loss: 2.254997  [12800/60000]\n","loss: 2.253916  [19200/60000]\n","loss: 2.225543  [25600/60000]\n","loss: 2.199220  [32000/60000]\n","loss: 2.211769  [38400/60000]\n","loss: 2.178261  [44800/60000]\n","loss: 2.173132  [51200/60000]\n","loss: 2.136191  [57600/60000]\n","Test Error: \n"," Accuracy: 48.6%, Avg loss: 2.130924 \n","\n","Epoch 2\n","-------------------------------\n","loss: 2.142797  [    0/60000]\n","loss: 2.134261  [ 6400/60000]\n","loss: 2.068551  [12800/60000]\n","loss: 2.087945  [19200/60000]\n","loss: 2.028864  [25600/60000]\n","loss: 1.965454  [32000/60000]\n","loss: 2.005360  [38400/60000]\n","loss: 1.924800  [44800/60000]\n","loss: 1.925460  [51200/60000]\n","loss: 1.851952  [57600/60000]\n","Test Error: \n"," Accuracy: 61.4%, Avg loss: 1.848820 \n","\n","Epoch 3\n","-------------------------------\n","loss: 1.881434  [    0/60000]\n","loss: 1.850708  [ 6400/60000]\n","loss: 1.724692  [12800/60000]\n","loss: 1.774836  [19200/60000]\n","loss: 1.654539  [25600/60000]\n","loss: 1.604158  [32000/60000]\n","loss: 1.637071  [38400/60000]\n","loss: 1.542645  [44800/60000]\n","loss: 1.560843  [51200/60000]\n","loss: 1.458579  [57600/60000]\n","Test Error: \n"," Accuracy: 63.5%, Avg loss: 1.477221 \n","\n","Epoch 4\n","-------------------------------\n","loss: 1.540991  [    0/60000]\n","loss: 1.506771  [ 6400/60000]\n","loss: 1.353815  [12800/60000]\n","loss: 1.436872  [19200/60000]\n","loss: 1.311692  [25600/60000]\n","loss: 1.304660  [32000/60000]\n","loss: 1.326661  [38400/60000]\n","loss: 1.261852  [44800/60000]\n","loss: 1.290649  [51200/60000]\n","loss: 1.191145  [57600/60000]\n","Test Error: \n"," Accuracy: 64.3%, Avg loss: 1.220972 \n","\n","Epoch 5\n","-------------------------------\n","loss: 1.294508  [    0/60000]\n","loss: 1.278188  [ 6400/60000]\n","loss: 1.111286  [12800/60000]\n","loss: 1.224184  [19200/60000]\n","loss: 1.095782  [25600/60000]\n","loss: 1.115965  [32000/60000]\n","loss: 1.143706  [38400/60000]\n","loss: 1.091679  [44800/60000]\n","loss: 1.123439  [51200/60000]\n","loss: 1.040862  [57600/60000]\n","Test Error: \n"," Accuracy: 65.3%, Avg loss: 1.064407 \n","\n","Done!\n"]}]},{"cell_type":"code","source":["torch.save(model.state_dict(), \"model.pth\")\n","print(\"Saved PyTorch Model State to model.pth\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6f3K8NUWfsDi","executionInfo":{"status":"ok","timestamp":1662429187983,"user_tz":-540,"elapsed":287,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"178eb969-0999-45c0-fd61-5c4acb100fc0"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["Saved PyTorch Model State to model.pth\n"]}]},{"cell_type":"code","source":["model = NeuralNetwork()\n","model.load_state_dict(torch.load(\"model.pth\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"o0aGmDL-fsit","executionInfo":{"status":"ok","timestamp":1662429192073,"user_tz":-540,"elapsed":303,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"6388dc97-ec34-4b31-c0e0-5b798c85ce79"},"execution_count":10,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["classes = [\n","    \"T-shirt/top\",\n","    \"Trouser\",\n","    \"Pullover\",\n","    \"Dress\",\n","    \"Coat\",\n","    \"Sandal\",\n","    \"Shirt\",\n","    \"Sneaker\",\n","    \"Bag\",\n","    \"Ankle boot\",\n","]\n","\n","model.eval()\n","x, y = test_data[0][0], test_data[0][1]\n","with torch.no_grad():\n","    pred = model(x)\n","    predicted, actual = classes[pred[0].argmax(0)], classes[y]\n","    print(f'Predicted: \"{predicted}\", Actual: \"{actual}\"')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZVTG1VCLfttQ","executionInfo":{"status":"ok","timestamp":1662429193979,"user_tz":-540,"elapsed":305,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"bab80f68-0236-458a-8e74-0562e8f55555"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["Predicted: \"Ankle boot\", Actual: \"Ankle boot\"\n"]}]},{"cell_type":"markdown","source":["#1"],"metadata":{"id":"WqvAqLATgHuc"}},{"cell_type":"code","source":["import torch\n","import numpy as np"],"metadata":{"id":"h4WlHXCbgIf6","executionInfo":{"status":"ok","timestamp":1662429208036,"user_tz":-540,"elapsed":302,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["data = [[1, 2],[3, 4]]\n","x_data = torch.tensor(data)"],"metadata":{"id":"KErrN6g9gJ0z","executionInfo":{"status":"ok","timestamp":1662429211989,"user_tz":-540,"elapsed":286,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["np_array = np.array(data)\n","x_np = torch.from_numpy(np_array)"],"metadata":{"id":"jLuXYvPJgLro","executionInfo":{"status":"ok","timestamp":1662429222577,"user_tz":-540,"elapsed":344,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["x_ones = torch.ones_like(x_data) \n","print(f\"Ones Tensor: \\n {x_ones} \\n\")\n","\n","x_rand = torch.rand_like(x_data, dtype=torch.float) \n","print(f\"Random Tensor: \\n {x_rand} \\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3qX8Miw0gNaA","executionInfo":{"status":"ok","timestamp":1662429231970,"user_tz":-540,"elapsed":309,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"df61fdc6-7886-4288-c3a4-868314b9a30c"},"execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["Ones Tensor: \n"," tensor([[1, 1],\n","        [1, 1]]) \n","\n","Random Tensor: \n"," tensor([[0.0296, 0.1030],\n","        [0.5167, 0.0543]]) \n","\n"]}]},{"cell_type":"code","source":["shape = (2,3,)\n","rand_tensor = torch.rand(shape)\n","ones_tensor = torch.ones(shape)\n","zeros_tensor = torch.zeros(shape)\n","\n","print(f\"Random Tensor: \\n {rand_tensor} \\n\")\n","print(f\"Ones Tensor: \\n {ones_tensor} \\n\")\n","print(f\"Zeros Tensor: \\n {zeros_tensor}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GIllungggPuN","executionInfo":{"status":"ok","timestamp":1662429234476,"user_tz":-540,"elapsed":290,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"ac091cb6-7b74-4a47-83eb-4321eb175a83"},"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["Random Tensor: \n"," tensor([[0.5454, 0.3221, 0.3305],\n","        [0.0272, 0.2702, 0.7486]]) \n","\n","Ones Tensor: \n"," tensor([[1., 1., 1.],\n","        [1., 1., 1.]]) \n","\n","Zeros Tensor: \n"," tensor([[0., 0., 0.],\n","        [0., 0., 0.]])\n"]}]},{"cell_type":"code","source":["tensor = torch.rand(3,4)\n","\n","print(f\"Shape of tensor: {tensor.shape}\")\n","print(f\"Datatype of tensor: {tensor.dtype}\")\n","print(f\"Device tensor is stored on: {tensor.device}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ToDDQYswgS0q","executionInfo":{"status":"ok","timestamp":1662429249424,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"3dc63d53-d05a-4637-fbec-fcce09a68e6a"},"execution_count":17,"outputs":[{"output_type":"stream","name":"stdout","text":["Shape of tensor: torch.Size([3, 4])\n","Datatype of tensor: torch.float32\n","Device tensor is stored on: cpu\n"]}]},{"cell_type":"code","source":["if torch.cuda.is_available():\n","    tensor = tensor.to(\"cuda\")"],"metadata":{"id":"iPd_28EHgUHy","executionInfo":{"status":"ok","timestamp":1662429258904,"user_tz":-540,"elapsed":456,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["tensor = torch.ones(4, 4)\n","print(f\"First row: {tensor[0]}\")\n","print(f\"First column: {tensor[:, 0]}\")\n","print(f\"Last column: {tensor[..., -1]}\")\n","tensor[:,1] = 0\n","print(tensor)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ozxcj3BjgWTV","executionInfo":{"status":"ok","timestamp":1662429263748,"user_tz":-540,"elapsed":286,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"be984730-038d-4e27-bba1-40a4dc7350de"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stdout","text":["First row: tensor([1., 1., 1., 1.])\n","First column: tensor([1., 1., 1., 1.])\n","Last column: tensor([1., 1., 1., 1.])\n","tensor([[1., 0., 1., 1.],\n","        [1., 0., 1., 1.],\n","        [1., 0., 1., 1.],\n","        [1., 0., 1., 1.]])\n"]}]},{"cell_type":"code","source":["t1 = torch.cat([tensor, tensor, tensor], dim=1)\n","print(t1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BIC6d_bkgXqb","executionInfo":{"status":"ok","timestamp":1662429269520,"user_tz":-540,"elapsed":468,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"3a3abef9-46df-4e7d-d88f-7c9749c1b544"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],\n","        [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],\n","        [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],\n","        [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.]])\n"]}]},{"cell_type":"code","source":["y1 = tensor @ tensor.T\n","y2 = tensor.matmul(tensor.T)\n","\n","y3 = torch.rand_like(y1)\n","torch.matmul(tensor, tensor.T, out=y3)\n","\n","\n","z1 = tensor * tensor\n","z2 = tensor.mul(tensor)\n","\n","z3 = torch.rand_like(tensor)\n","torch.mul(tensor, tensor, out=z3)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fqu7Yrr1gaEx","executionInfo":{"status":"ok","timestamp":1662429281079,"user_tz":-540,"elapsed":315,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"9f0df4f5-cf44-470f-8d39-6a3280cfb52f"},"execution_count":21,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[1., 0., 1., 1.],\n","        [1., 0., 1., 1.],\n","        [1., 0., 1., 1.],\n","        [1., 0., 1., 1.]])"]},"metadata":{},"execution_count":21}]},{"cell_type":"code","source":["agg = tensor.sum()\n","agg_item = agg.item()\n","print(agg_item, type(agg_item))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JLkoT4nygczL","executionInfo":{"status":"ok","timestamp":1662429287624,"user_tz":-540,"elapsed":283,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"5c82aab6-9f67-4909-8ef7-173dbc3f8ff0"},"execution_count":22,"outputs":[{"output_type":"stream","name":"stdout","text":["12.0 <class 'float'>\n"]}]},{"cell_type":"code","source":["print(f\"{tensor} \\n\")\n","tensor.add_(5)\n","print(tensor)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"59EARq9_geqJ","executionInfo":{"status":"ok","timestamp":1662429295254,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"bc0f5b79-503a-4529-b5d2-2c1d3db088c2"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[1., 0., 1., 1.],\n","        [1., 0., 1., 1.],\n","        [1., 0., 1., 1.],\n","        [1., 0., 1., 1.]]) \n","\n","tensor([[6., 5., 6., 6.],\n","        [6., 5., 6., 6.],\n","        [6., 5., 6., 6.],\n","        [6., 5., 6., 6.]])\n"]}]},{"cell_type":"code","source":["t = torch.ones(5)\n","print(f\"t: {t}\")\n","n = t.numpy()\n","print(f\"n: {n}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nV_VaUmHggYT","executionInfo":{"status":"ok","timestamp":1662429302283,"user_tz":-540,"elapsed":469,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"22346ea1-ebd1-4510-d6c7-2a246459513e"},"execution_count":24,"outputs":[{"output_type":"stream","name":"stdout","text":["t: tensor([1., 1., 1., 1., 1.])\n","n: [1. 1. 1. 1. 1.]\n"]}]},{"cell_type":"code","source":["t.add_(1)\n","print(f\"t: {t}\")\n","print(f\"n: {n}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Co9Dc1E1ghpW","executionInfo":{"status":"ok","timestamp":1662429308000,"user_tz":-540,"elapsed":494,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"fa37f8e7-1f78-41d7-afb9-1ca238d7bb97"},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["t: tensor([2., 2., 2., 2., 2.])\n","n: [2. 2. 2. 2. 2.]\n"]}]},{"cell_type":"code","source":["n = np.ones(5)\n","t = torch.from_numpy(n)"],"metadata":{"id":"AUXdqu5JgjTB","executionInfo":{"status":"ok","timestamp":1662429314625,"user_tz":-540,"elapsed":1,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["np.add(n, 1, out=n)\n","print(f\"t: {t}\")\n","print(f\"n: {n}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4yuy5tBFgkxK","executionInfo":{"status":"ok","timestamp":1662429320262,"user_tz":-540,"elapsed":293,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"5a9762d5-0eab-4eef-d496-52ad7956e830"},"execution_count":27,"outputs":[{"output_type":"stream","name":"stdout","text":["t: tensor([2., 2., 2., 2., 2.], dtype=torch.float64)\n","n: [2. 2. 2. 2. 2.]\n"]}]},{"cell_type":"markdown","source":["#2"],"metadata":{"id":"A8DQDGvKgpHi"}},{"cell_type":"code","source":["import torch\n","from torch.utils.data import Dataset\n","from torchvision import datasets\n","from torchvision.transforms import ToTensor\n","import matplotlib.pyplot as plt\n","\n","\n","training_data = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=True,\n","    download=True,\n","    transform=ToTensor()\n",")\n","\n","test_data = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=False,\n","    download=True,\n","    transform=ToTensor()\n",")"],"metadata":{"id":"2XjE_PMzgqW6","executionInfo":{"status":"ok","timestamp":1662429363620,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","source":["labels_map = {\n","    0: \"T-Shirt\",\n","    1: \"Trouser\",\n","    2: \"Pullover\",\n","    3: \"Dress\",\n","    4: \"Coat\",\n","    5: \"Sandal\",\n","    6: \"Shirt\",\n","    7: \"Sneaker\",\n","    8: \"Bag\",\n","    9: \"Ankle Boot\",\n","}\n","figure = plt.figure(figsize=(8, 8))\n","cols, rows = 3, 3\n","for i in range(1, cols * rows + 1):\n","    sample_idx = torch.randint(len(training_data), size=(1,)).item()\n","    img, label = training_data[sample_idx]\n","    figure.add_subplot(rows, cols, i)\n","    plt.title(labels_map[label])\n","    plt.axis(\"off\")\n","    plt.imshow(img.squeeze(), cmap=\"gray\")\n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":482},"id":"DaRoKNnFgv15","executionInfo":{"status":"ok","timestamp":1662429369747,"user_tz":-540,"elapsed":1346,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"f95934c7-339e-48d3-f2d6-b27da21d6ddf"},"execution_count":29,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 576x576 with 9 Axes>"],"image/png":"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k1NY29bvzVopRG/HOvdZSWZ6xRyrf6dMZqC386UvfSloUxVeSRIREUVwkCQiIorgIElERBRRMjHJ1MkE9EP4KRNNV+fEAYVMjK7viQNpMUkrBkGlS0/SryeoBsIHovXk1zE6ZqMfUAfCmI0V+yKbteDAhx9+6JWt76OeLNz6XDp16uSV9cTdgP2Avf7Me/fuHbTRn7kV29PnLKuNVafjfdYE73r/vXr1Ctro39uSJUuCNtYkALr/Wnkj+vdt5Z/o/aUuKlCBV5JEREQRHCSJiIgiOEgSERFFcJAkIiKKqHOJO/rh3YULF+Z9TUowO5VO1ElJ3CkrKwvqUh781g+QU2nTKxJ07949aKP7XeqEEbq/pEyQoR80pzjr9/mv//qveV+nk3DOOOOMoM2QIUO88uDBg4M2/fr1C+r0RBPWg/p6FQ4rWUuv+mGtpmElF86ePdsr60QmAPj000+98n//938Hbc466yyvPGHChKCNdT7Un0nKpCzWOVN/Dz755JOgTVV4JUlERBTBQZKIiCiCgyQREVEEB0kiIqKIkons69lKYnTigw4uW6ygvN6O1SZFyut0QgcArF27Nu/rli5dWsghUZGsXLnSK+vVD4AwiSw1gUwnX1h0YoNO6qADkzK7lk68evHFF4M2Vl0hOnToENTphBerP+mZcqwknULPfymef/55r6wTmQA7mShlNiGdyGklwqUkV954443Rn/FKkoiIKIKDJBERUQQHSSIiooiSiUleeeWVBbW744478r7GWq26OlcGycdaYeDmm2/O+zrroeO33367Wo6Jqp9+kNmKSWrW6g8p27boeNSiRYuStk222jxHpFi/fn2xD6FazJkzp9iHcEB4JUlERBTBQZKIiCiCgyQREVEEB0kiIqIIqSo4LSI1FrnWCQvWA/dt2rTJu5158+YFdb169fLKO3fuDNropArr95DygK2VnNGkSROvnPKAr2XTpk1BnU7mWb16dd7tFMo5V9hSKQepJvtdTdJJZXfeeWfQRifgdOrUKWhj1bVv394rz5w5M2izfft2r6wftAaAESNGBHWlphj9rq72OaoeVfU5XkkSERFFcJAkIiKK4CBJREQUUbTJBE455RSvPHXq1KCNNem5jsHp+CMADBgwwCtbk97qCQZSJ5rWsUtrRW29grj1PpYtW+aVdcwJsOO0Oqb06quvRo+VapeO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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["import os\n","import pandas as pd\n","from torchvision.io import read_image\n","\n","class CustomImageDataset(Dataset):\n","    def __init__(self, annotations_file, img_dir, transform=None, target_transform=None):\n","        self.img_labels = pd.read_csv(annotations_file, names=['file_name', 'label'])\n","        self.img_dir = img_dir\n","        self.transform = transform\n","        self.target_transform = target_transform\n","\n","    def __len__(self):\n","        return len(self.img_labels)\n","\n","    def __getitem__(self, idx):\n","        img_path = os.path.join(self.img_dir, self.img_labels.iloc[idx, 0])\n","        image = read_image(img_path)\n","        label = self.img_labels.iloc[idx, 1]\n","        if self.transform:\n","            image = self.transform(image)\n","        if self.target_transform:\n","            label = self.target_transform(label)\n","        return image, label"],"metadata":{"id":"s3PR_y6Ugz99","executionInfo":{"status":"ok","timestamp":1662429383661,"user_tz":-540,"elapsed":797,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":30,"outputs":[]},{"cell_type":"code","source":["def __init__(self, annotations_file, img_dir, transform=None, target_transform=None):\n","    self.img_labels = pd.read_csv(annotations_file)\n","    self.img_dir = img_dir\n","    self.transform = transform\n","    self.target_transform = target_transform"],"metadata":{"id":"QrXLWS5Rg7uR","executionInfo":{"status":"ok","timestamp":1662429419224,"user_tz":-540,"elapsed":295,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":32,"outputs":[]},{"cell_type":"code","source":["def __len__(self):\n","    return len(self.img_labels)"],"metadata":{"id":"A8vrFHn-g9rd","executionInfo":{"status":"ok","timestamp":1662429427117,"user_tz":-540,"elapsed":292,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":33,"outputs":[]},{"cell_type":"code","source":["def __getitem__(self, idx):\n","    img_path = os.path.join(self.img_dir, self.img_labels.iloc[idx, 0])\n","    image = read_image(img_path)\n","    label = self.img_labels.iloc[idx, 1]\n","    if self.transform:\n","        image = self.transform(image)\n","    if self.target_transform:\n","        label = self.target_transform(label)\n","    sample = {\"image\": image, \"label\": label}\n","    return sample"],"metadata":{"id":"rzR2VyYmg_cg","executionInfo":{"status":"ok","timestamp":1662429435282,"user_tz":-540,"elapsed":284,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":34,"outputs":[]},{"cell_type":"code","source":["from torch.utils.data import DataLoader\n","\n","train_dataloader = DataLoader(training_data, batch_size=64, shuffle=True)\n","test_dataloader = DataLoader(test_data, batch_size=64, shuffle=True)"],"metadata":{"id":"UaSYT5jthBhL","executionInfo":{"status":"ok","timestamp":1662429441510,"user_tz":-540,"elapsed":310,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":["train_features, train_labels = next(iter(train_dataloader))\n","print(f\"Feature batch shape: {train_features.size()}\")\n","print(f\"Labels batch shape: {train_labels.size()}\")\n","img = train_features[0].squeeze()\n","label = train_labels[0]\n","plt.imshow(img, cmap=\"gray\")\n","plt.show()\n","print(f\"Label: {label}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":320},"id":"UctB20nVhC91","executionInfo":{"status":"ok","timestamp":1662429452113,"user_tz":-540,"elapsed":759,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"f8a08b5f-a590-4ecf-c287-b5e83fb77544"},"execution_count":36,"outputs":[{"output_type":"stream","name":"stdout","text":["Feature batch shape: torch.Size([64, 1, 28, 28])\n","Labels batch shape: torch.Size([64])\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}},{"output_type":"stream","name":"stdout","text":["Label: 2\n"]}]},{"cell_type":"markdown","source":["#3"],"metadata":{"id":"K4p8EIpDhZhL"}},{"cell_type":"code","source":["import torch\n","from torchvision import datasets\n","from torchvision.transforms import ToTensor, Lambda\n","\n","ds = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=True,\n","    download=True,\n","    transform=ToTensor(),\n","    target_transform=Lambda(lambda y: torch.zeros(10, dtype=torch.float).scatter_(0, torch.tensor(y), value=1))\n",")"],"metadata":{"id":"mx_y91tghcZW","executionInfo":{"status":"ok","timestamp":1662429555343,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":["target_transform = Lambda(lambda y: torch.zeros(\n","    10, dtype=torch.float).scatter_(dim=0, index=torch.tensor(y), value=1))"],"metadata":{"id":"UIIlR4vrherc","executionInfo":{"status":"ok","timestamp":1662429574534,"user_tz":-540,"elapsed":323,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":38,"outputs":[]},{"cell_type":"markdown","source":["#4"],"metadata":{"id":"t03w5qkJhoe2"}},{"cell_type":"code","source":["import os\n","import torch\n","from torch import nn\n","from torch.utils.data import DataLoader\n","from torchvision import datasets, transforms"],"metadata":{"id":"i3fUuAsHhpDe","executionInfo":{"status":"ok","timestamp":1662429684256,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":39,"outputs":[]},{"cell_type":"code","source":["device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n","print(f\"Using {device} device\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"B6WejZGsh-GX","executionInfo":{"status":"ok","timestamp":1662429694070,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"7d2bc9b2-a57d-4885-a393-ad17911d73a4"},"execution_count":40,"outputs":[{"output_type":"stream","name":"stdout","text":["Using cpu device\n"]}]},{"cell_type":"code","source":["class NeuralNetwork(nn.Module):\n","    def __init__(self):\n","        super(NeuralNetwork, self).__init__()\n","        self.flatten = nn.Flatten()\n","        self.linear_relu_stack = nn.Sequential(\n","            nn.Linear(28*28, 512),\n","            nn.ReLU(),\n","            nn.Linear(512, 512),\n","            nn.ReLU(),\n","            nn.Linear(512, 10),\n","        )\n","\n","    def forward(self, x):\n","        x = self.flatten(x)\n","        logits = self.linear_relu_stack(x)\n","        return logits"],"metadata":{"id":"Cck7eZm9h-Ls","executionInfo":{"status":"ok","timestamp":1662429699780,"user_tz":-540,"elapsed":1,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":41,"outputs":[]},{"cell_type":"code","source":["model = NeuralNetwork().to(device)\n","print(model)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vuM1s8oOiDom","executionInfo":{"status":"ok","timestamp":1662429710007,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"48e61768-bde4-468d-d8e1-da397260faa9"},"execution_count":42,"outputs":[{"output_type":"stream","name":"stdout","text":["NeuralNetwork(\n","  (flatten): Flatten(start_dim=1, end_dim=-1)\n","  (linear_relu_stack): Sequential(\n","    (0): Linear(in_features=784, out_features=512, bias=True)\n","    (1): ReLU()\n","    (2): Linear(in_features=512, out_features=512, bias=True)\n","    (3): ReLU()\n","    (4): Linear(in_features=512, out_features=10, bias=True)\n","  )\n",")\n"]}]},{"cell_type":"code","source":["X = torch.rand(1, 28, 28, device=device)\n","logits = model(X)\n","pred_probab = nn.Softmax(dim=1)(logits)\n","y_pred = pred_probab.argmax(1)\n","print(f\"Predicted class: {y_pred}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mco7ODKKiFfL","executionInfo":{"status":"ok","timestamp":1662429716723,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"2c8918c7-9e05-4f29-e398-583c62d0b717"},"execution_count":43,"outputs":[{"output_type":"stream","name":"stdout","text":["Predicted class: tensor([5])\n"]}]},{"cell_type":"code","source":["input_image = torch.rand(3,28,28)\n","print(input_image.size())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oDBPltWbiHXW","executionInfo":{"status":"ok","timestamp":1662429728891,"user_tz":-540,"elapsed":319,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"d17bdf72-0535-482a-c4bb-8c1a3a9f996a"},"execution_count":44,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([3, 28, 28])\n"]}]},{"cell_type":"code","source":["flatten = nn.Flatten()\n","flat_image = flatten(input_image)\n","print(flat_image.size())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gUaTM6CZiLiZ","executionInfo":{"status":"ok","timestamp":1662429741387,"user_tz":-540,"elapsed":390,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"f58c1791-cf41-439c-9735-36da858ba25b"},"execution_count":45,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([3, 784])\n"]}]},{"cell_type":"code","source":["layer1 = nn.Linear(in_features=28*28, out_features=20)\n","hidden1 = layer1(flat_image)\n","print(hidden1.size())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OOdnhmx-iNbN","executionInfo":{"status":"ok","timestamp":1662429750608,"user_tz":-540,"elapsed":348,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"eb0d9251-b3b5-4dca-f470-cefa62e1fff7"},"execution_count":46,"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([3, 20])\n"]}]},{"cell_type":"code","source":["print(f\"Before ReLU: {hidden1}\\n\\n\")\n","hidden1 = nn.ReLU()(hidden1)\n","print(f\"After ReLU: {hidden1}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Jig-UKTpiPBS","executionInfo":{"status":"ok","timestamp":1662429755943,"user_tz":-540,"elapsed":473,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"7a1bb467-5737-4973-8d33-03f6c2850c36"},"execution_count":47,"outputs":[{"output_type":"stream","name":"stdout","text":["Before ReLU: tensor([[ 0.6050,  0.6695,  0.3266,  0.0716, -0.0728, -0.2898,  0.1905, -0.0690,\n","          0.1618, -0.4572,  0.0521,  0.0459,  0.0935,  0.1664, -0.3196, -0.4172,\n","          0.1699, -0.1371,  0.0012,  0.0475],\n","        [ 0.3339,  0.7517,  0.1836,  0.2105, -0.0380, -0.0258,  0.2630,  0.0506,\n","          0.0761, -0.0124,  0.0476, -0.2648,  0.0622,  0.1698,  0.1216, -0.4211,\n","         -0.0445, -0.0731, -0.0406,  0.4589],\n","        [ 0.5212,  0.7676,  0.3404, -0.0816,  0.1049, -0.3638,  0.2251, -0.0224,\n","          0.0335, -0.0086,  0.1359, -0.3770,  0.2872,  0.3283,  0.0415, -0.6399,\n","         -0.0833, -0.0706,  0.0901,  0.2699]], grad_fn=<AddmmBackward0>)\n","\n","\n","After ReLU: tensor([[0.6050, 0.6695, 0.3266, 0.0716, 0.0000, 0.0000, 0.1905, 0.0000, 0.1618,\n","         0.0000, 0.0521, 0.0459, 0.0935, 0.1664, 0.0000, 0.0000, 0.1699, 0.0000,\n","         0.0012, 0.0475],\n","        [0.3339, 0.7517, 0.1836, 0.2105, 0.0000, 0.0000, 0.2630, 0.0506, 0.0761,\n","         0.0000, 0.0476, 0.0000, 0.0622, 0.1698, 0.1216, 0.0000, 0.0000, 0.0000,\n","         0.0000, 0.4589],\n","        [0.5212, 0.7676, 0.3404, 0.0000, 0.1049, 0.0000, 0.2251, 0.0000, 0.0335,\n","         0.0000, 0.1359, 0.0000, 0.2872, 0.3283, 0.0415, 0.0000, 0.0000, 0.0000,\n","         0.0901, 0.2699]], grad_fn=<ReluBackward0>)\n"]}]},{"cell_type":"code","source":["seq_modules = nn.Sequential(\n","    flatten,\n","    layer1,\n","    nn.ReLU(),\n","    nn.Linear(20, 10)\n",")\n","input_image = torch.rand(3,28,28)\n","logits = seq_modules(input_image)"],"metadata":{"id":"dwqdTIYjiQwV","executionInfo":{"status":"ok","timestamp":1662429765947,"user_tz":-540,"elapsed":286,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":48,"outputs":[]},{"cell_type":"code","source":["softmax = nn.Softmax(dim=1)\n","pred_probab = softmax(logits)"],"metadata":{"id":"Fvr8UMRSiS9C","executionInfo":{"status":"ok","timestamp":1662429771509,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":49,"outputs":[]},{"cell_type":"code","source":["print(f\"Model structure: {model}\\n\\n\")\n","\n","for name, param in model.named_parameters():\n","    print(f\"Layer: {name} | Size: {param.size()} | Values : {param[:2]} \\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NLGuGokBiUZa","executionInfo":{"status":"ok","timestamp":1662429777285,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"c2ce2c98-1bd7-40b9-a215-c0b8295419e0"},"execution_count":50,"outputs":[{"output_type":"stream","name":"stdout","text":["Model structure: NeuralNetwork(\n","  (flatten): Flatten(start_dim=1, end_dim=-1)\n","  (linear_relu_stack): Sequential(\n","    (0): Linear(in_features=784, out_features=512, bias=True)\n","    (1): ReLU()\n","    (2): Linear(in_features=512, out_features=512, bias=True)\n","    (3): ReLU()\n","    (4): Linear(in_features=512, out_features=10, bias=True)\n","  )\n",")\n","\n","\n","Layer: linear_relu_stack.0.weight | Size: torch.Size([512, 784]) | Values : tensor([[ 2.0745e-02, -6.5268e-03, -2.1616e-02,  ...,  2.5042e-02,\n","         -1.8305e-02, -2.1377e-05],\n","        [ 5.2065e-03,  2.4970e-02,  5.7873e-03,  ...,  2.8599e-02,\n","         -5.6762e-03, -1.7911e-02]], grad_fn=<SliceBackward0>) \n","\n","Layer: linear_relu_stack.0.bias | Size: torch.Size([512]) | Values : tensor([-0.0039, -0.0050], grad_fn=<SliceBackward0>) \n","\n","Layer: linear_relu_stack.2.weight | Size: torch.Size([512, 512]) | Values : tensor([[-0.0003, -0.0265,  0.0023,  ...,  0.0370,  0.0301,  0.0280],\n","        [-0.0048, -0.0232,  0.0190,  ..., -0.0218, -0.0236,  0.0057]],\n","       grad_fn=<SliceBackward0>) \n","\n","Layer: linear_relu_stack.2.bias | Size: torch.Size([512]) | Values : tensor([0.0232, 0.0243], grad_fn=<SliceBackward0>) \n","\n","Layer: linear_relu_stack.4.weight | Size: torch.Size([10, 512]) | Values : tensor([[ 0.0163,  0.0295,  0.0077,  ..., -0.0326,  0.0061,  0.0087],\n","        [ 0.0023, -0.0255, -0.0132,  ..., -0.0176, -0.0051, -0.0143]],\n","       grad_fn=<SliceBackward0>) \n","\n","Layer: linear_relu_stack.4.bias | Size: torch.Size([10]) | Values : tensor([-0.0408,  0.0163], grad_fn=<SliceBackward0>) \n","\n"]}]},{"cell_type":"markdown","source":["#5"],"metadata":{"id":"gY9NTBApiWgY"}},{"cell_type":"code","source":["import torch\n","\n","x = torch.ones(5)  # input tensor\n","y = torch.zeros(3)  # expected output\n","w = torch.randn(5, 3, requires_grad=True)\n","b = torch.randn(3, requires_grad=True)\n","z = torch.matmul(x, w)+b\n","loss = torch.nn.functional.binary_cross_entropy_with_logits(z, y)"],"metadata":{"id":"pacxY-KYiYFS","executionInfo":{"status":"ok","timestamp":1662429800258,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":51,"outputs":[]},{"cell_type":"code","source":["print(f\"Gradient function for z = {z.grad_fn}\")\n","print(f\"Gradient function for loss = {loss.grad_fn}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"j56_8K7XiagA","executionInfo":{"status":"ok","timestamp":1662429809619,"user_tz":-540,"elapsed":284,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"78a51b41-01e6-4e05-e635-042f39e20754"},"execution_count":52,"outputs":[{"output_type":"stream","name":"stdout","text":["Gradient function for z = <AddBackward0 object at 0x7f8000fb6a50>\n","Gradient function for loss = <BinaryCrossEntropyWithLogitsBackward0 object at 0x7f8000fb6bd0>\n"]}]},{"cell_type":"code","source":["loss.backward()\n","print(w.grad)\n","print(b.grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cy8SQ0hYidAB","executionInfo":{"status":"ok","timestamp":1662429817164,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"c580a4d7-462f-43bf-80e0-083a1b804699"},"execution_count":53,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[0.1151, 0.3312, 0.0150],\n","        [0.1151, 0.3312, 0.0150],\n","        [0.1151, 0.3312, 0.0150],\n","        [0.1151, 0.3312, 0.0150],\n","        [0.1151, 0.3312, 0.0150]])\n","tensor([0.1151, 0.3312, 0.0150])\n"]}]},{"cell_type":"code","source":["z = torch.matmul(x, w)+b\n","print(z.requires_grad)\n","\n","with torch.no_grad():\n","    z = torch.matmul(x, w)+b\n","print(z.requires_grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GgQuZa5Aigpf","executionInfo":{"status":"ok","timestamp":1662429827757,"user_tz":-540,"elapsed":294,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"60171e29-ea8c-4e26-8be1-517c84abd957"},"execution_count":54,"outputs":[{"output_type":"stream","name":"stdout","text":["True\n","False\n"]}]},{"cell_type":"code","source":["z = torch.matmul(x, w)+b\n","z_det = z.detach()\n","print(z_det.requires_grad)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-5xcbtmCih_1","executionInfo":{"status":"ok","timestamp":1662429833629,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"1ca6012b-c73b-406a-a486-43b8d9924b79"},"execution_count":55,"outputs":[{"output_type":"stream","name":"stdout","text":["False\n"]}]},{"cell_type":"code","source":["inp = torch.eye(5, requires_grad=True)\n","out = (inp+1).pow(2)\n","out.backward(torch.ones_like(inp), retain_graph=True)\n","print(f\"First call\\n{inp.grad}\")\n","out.backward(torch.ones_like(inp), retain_graph=True)\n","print(f\"\\nSecond call\\n{inp.grad}\")\n","inp.grad.zero_()\n","out.backward(torch.ones_like(inp), retain_graph=True)\n","print(f\"\\nCall after zeroing gradients\\n{inp.grad}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CiDiFs8Hikx6","executionInfo":{"status":"ok","timestamp":1662429844513,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"2d94a5e6-c318-4e7c-ae55-bec1999577d2"},"execution_count":56,"outputs":[{"output_type":"stream","name":"stdout","text":["First call\n","tensor([[4., 2., 2., 2., 2.],\n","        [2., 4., 2., 2., 2.],\n","        [2., 2., 4., 2., 2.],\n","        [2., 2., 2., 4., 2.],\n","        [2., 2., 2., 2., 4.]])\n","\n","Second call\n","tensor([[8., 4., 4., 4., 4.],\n","        [4., 8., 4., 4., 4.],\n","        [4., 4., 8., 4., 4.],\n","        [4., 4., 4., 8., 4.],\n","        [4., 4., 4., 4., 8.]])\n","\n","Call after zeroing gradients\n","tensor([[4., 2., 2., 2., 2.],\n","        [2., 4., 2., 2., 2.],\n","        [2., 2., 4., 2., 2.],\n","        [2., 2., 2., 4., 2.],\n","        [2., 2., 2., 2., 4.]])\n"]}]},{"cell_type":"markdown","source":["#6"],"metadata":{"id":"tJ0GpduSioWS"}},{"cell_type":"code","source":["import torch\n","from torch import nn\n","from torch.utils.data import DataLoader\n","from torchvision import datasets\n","from torchvision.transforms import ToTensor, Lambda\n","\n","training_data = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=True,\n","    download=True,\n","    transform=ToTensor()\n",")\n","\n","test_data = datasets.FashionMNIST(\n","    root=\"data\",\n","    train=False,\n","    download=True,\n","    transform=ToTensor()\n",")\n","\n","train_dataloader = DataLoader(training_data, batch_size=64)\n","test_dataloader = DataLoader(test_data, batch_size=64)\n","\n","class NeuralNetwork(nn.Module):\n","    def __init__(self):\n","        super(NeuralNetwork, self).__init__()\n","        self.flatten = nn.Flatten()\n","        self.linear_relu_stack = nn.Sequential(\n","            nn.Linear(28*28, 512),\n","            nn.ReLU(),\n","            nn.Linear(512, 512),\n","            nn.ReLU(),\n","            nn.Linear(512, 10),\n","        )\n","\n","    def forward(self, x):\n","        x = self.flatten(x)\n","        logits = self.linear_relu_stack(x)\n","        return logits\n","\n","model = NeuralNetwork()"],"metadata":{"id":"aXqHVFWRiqk4","executionInfo":{"status":"ok","timestamp":1662429912240,"user_tz":-540,"elapsed":288,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":57,"outputs":[]},{"cell_type":"code","source":["learning_rate = 1e-3\n","batch_size = 64\n","epochs = 5"],"metadata":{"id":"5MwJG8abi3ZU","executionInfo":{"status":"ok","timestamp":1662429922207,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":58,"outputs":[]},{"cell_type":"code","source":["loss_fn = nn.CrossEntropyLoss()"],"metadata":{"id":"rRtuNE99i5uJ","executionInfo":{"status":"ok","timestamp":1662429931844,"user_tz":-540,"elapsed":287,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":59,"outputs":[]},{"cell_type":"code","source":["optimizer = torch.optim.SGD(model.parameters(), lr=learning_rate)"],"metadata":{"id":"1QS_haZ4i7wb","executionInfo":{"status":"ok","timestamp":1662429939418,"user_tz":-540,"elapsed":2,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":60,"outputs":[]},{"cell_type":"code","source":["def train_loop(dataloader, model, loss_fn, optimizer):\n","    size = len(dataloader.dataset)\n","    for batch, (X, y) in enumerate(dataloader):\n","        pred = model(X)\n","        loss = loss_fn(pred, y)\n","\n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()\n","\n","        if batch % 100 == 0:\n","            loss, current = loss.item(), batch * len(X)\n","            print(f\"loss: {loss:>7f}  [{current:>5d}/{size:>5d}]\")\n","\n","\n","def test_loop(dataloader, model, loss_fn):\n","    size = len(dataloader.dataset)\n","    num_batches = len(dataloader)\n","    test_loss, correct = 0, 0\n","\n","    with torch.no_grad():\n","        for X, y in dataloader:\n","            pred = model(X)\n","            test_loss += loss_fn(pred, y).item()\n","            correct += (pred.argmax(1) == y).type(torch.float).sum().item()\n","\n","    test_loss /= num_batches\n","    correct /= size\n","    print(f\"Test Error: \\n Accuracy: {(100*correct):>0.1f}%, Avg loss: {test_loss:>8f} \\n\")"],"metadata":{"id":"CmK3zPWIi93r","executionInfo":{"status":"ok","timestamp":1662429953533,"user_tz":-540,"elapsed":1,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":61,"outputs":[]},{"cell_type":"code","source":["loss_fn = nn.CrossEntropyLoss()\n","optimizer = torch.optim.SGD(model.parameters(), lr=learning_rate)\n","\n","epochs = 10\n","for t in range(epochs):\n","    print(f\"Epoch {t+1}\\n-------------------------------\")\n","    train_loop(train_dataloader, model, loss_fn, optimizer)\n","    test_loop(test_dataloader, model, loss_fn)\n","print(\"Done!\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0anA2bTYjBx9","executionInfo":{"status":"ok","timestamp":1662430084820,"user_tz":-540,"elapsed":120962,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"f6305c56-9502-458f-99e2-c9cbca6a20bc"},"execution_count":62,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1\n","-------------------------------\n","loss: 2.311452  [    0/60000]\n","loss: 2.295846  [ 6400/60000]\n","loss: 2.274675  [12800/60000]\n","loss: 2.267535  [19200/60000]\n","loss: 2.258380  [25600/60000]\n","loss: 2.223387  [32000/60000]\n","loss: 2.241764  [38400/60000]\n","loss: 2.208928  [44800/60000]\n","loss: 2.199381  [51200/60000]\n","loss: 2.180559  [57600/60000]\n","Test Error: \n"," Accuracy: 41.3%, Avg loss: 2.165196 \n","\n","Epoch 2\n","-------------------------------\n","loss: 2.175756  [    0/60000]\n","loss: 2.163255  [ 6400/60000]\n","loss: 2.111501  [12800/60000]\n","loss: 2.132715  [19200/60000]\n","loss: 2.082798  [25600/60000]\n","loss: 2.013580  [32000/60000]\n","loss: 2.060234  [38400/60000]\n","loss: 1.979740  [44800/60000]\n","loss: 1.982697  [51200/60000]\n","loss: 1.924375  [57600/60000]\n","Test Error: \n"," Accuracy: 57.2%, Avg loss: 1.912101 \n","\n","Epoch 3\n","-------------------------------\n","loss: 1.941577  [    0/60000]\n","loss: 1.909305  [ 6400/60000]\n","loss: 1.803230  [12800/60000]\n","loss: 1.851833  [19200/60000]\n","loss: 1.730325  [25600/60000]\n","loss: 1.673911  [32000/60000]\n","loss: 1.719020  [38400/60000]\n","loss: 1.614725  [44800/60000]\n","loss: 1.637761  [51200/60000]\n","loss: 1.535112  [57600/60000]\n","Test Error: \n"," Accuracy: 60.6%, Avg loss: 1.547268 \n","\n","Epoch 4\n","-------------------------------\n","loss: 1.613378  [    0/60000]\n","loss: 1.573897  [ 6400/60000]\n","loss: 1.433337  [12800/60000]\n","loss: 1.503990  [19200/60000]\n","loss: 1.373377  [25600/60000]\n","loss: 1.361616  [32000/60000]\n","loss: 1.391220  [38400/60000]\n","loss: 1.315168  [44800/60000]\n","loss: 1.343363  [51200/60000]\n","loss: 1.235332  [57600/60000]\n","Test Error: \n"," Accuracy: 63.0%, Avg loss: 1.267182 \n","\n","Epoch 5\n","-------------------------------\n","loss: 1.347525  [    0/60000]\n","loss: 1.326144  [ 6400/60000]\n","loss: 1.167240  [12800/60000]\n","loss: 1.267267  [19200/60000]\n","loss: 1.137593  [25600/60000]\n","loss: 1.151905  [32000/60000]\n","loss: 1.186471  [38400/60000]\n","loss: 1.125707  [44800/60000]\n","loss: 1.158214  [51200/60000]\n","loss: 1.061693  [57600/60000]\n","Test Error: \n"," Accuracy: 64.6%, Avg loss: 1.092552 \n","\n","Epoch 6\n","-------------------------------\n","loss: 1.168774  [    0/60000]\n","loss: 1.166639  [ 6400/60000]\n","loss: 0.989574  [12800/60000]\n","loss: 1.120093  [19200/60000]\n","loss: 0.993344  [25600/60000]\n","loss: 1.011793  [32000/60000]\n","loss: 1.063200  [38400/60000]\n","loss: 1.005810  [44800/60000]\n","loss: 1.040907  [51200/60000]\n","loss: 0.956346  [57600/60000]\n","Test Error: \n"," Accuracy: 65.6%, Avg loss: 0.981966 \n","\n","Epoch 7\n","-------------------------------\n","loss: 1.047106  [    0/60000]\n","loss: 1.064605  [ 6400/60000]\n","loss: 0.868981  [12800/60000]\n","loss: 1.024104  [19200/60000]\n","loss: 0.905437  [25600/60000]\n","loss: 0.915031  [32000/60000]\n","loss: 0.984867  [38400/60000]\n","loss: 0.928119  [44800/60000]\n","loss: 0.961823  [51200/60000]\n","loss: 0.888119  [57600/60000]\n","Test Error: \n"," Accuracy: 66.9%, Avg loss: 0.908202 \n","\n","Epoch 8\n","-------------------------------\n","loss: 0.958947  [    0/60000]\n","loss: 0.995361  [ 6400/60000]\n","loss: 0.784064  [12800/60000]\n","loss: 0.958006  [19200/60000]\n","loss: 0.848425  [25600/60000]\n","loss: 0.845508  [32000/60000]\n","loss: 0.930894  [38400/60000]\n","loss: 0.876176  [44800/60000]\n","loss: 0.905637  [51200/60000]\n","loss: 0.840510  [57600/60000]\n","Test Error: \n"," Accuracy: 67.9%, Avg loss: 0.855961 \n","\n","Epoch 9\n","-------------------------------\n","loss: 0.891529  [    0/60000]\n","loss: 0.944647  [ 6400/60000]\n","loss: 0.721876  [12800/60000]\n","loss: 0.909990  [19200/60000]\n","loss: 0.808762  [25600/60000]\n","loss: 0.794390  [32000/60000]\n","loss: 0.890408  [38400/60000]\n","loss: 0.839817  [44800/60000]\n","loss: 0.864314  [51200/60000]\n","loss: 0.804583  [57600/60000]\n","Test Error: \n"," Accuracy: 69.2%, Avg loss: 0.816904 \n","\n","Epoch 10\n","-------------------------------\n","loss: 0.838046  [    0/60000]\n","loss: 0.904703  [ 6400/60000]\n","loss: 0.674785  [12800/60000]\n","loss: 0.873553  [19200/60000]\n","loss: 0.779158  [25600/60000]\n","loss: 0.755581  [32000/60000]\n","loss: 0.857766  [38400/60000]\n","loss: 0.812739  [44800/60000]\n","loss: 0.832418  [51200/60000]\n","loss: 0.776123  [57600/60000]\n","Test Error: \n"," Accuracy: 70.5%, Avg loss: 0.786117 \n","\n","Done!\n"]}]},{"cell_type":"markdown","source":["#7"],"metadata":{"id":"7ZmUe25bjEJo"}},{"cell_type":"code","source":["import torch\n","import torchvision.models as models"],"metadata":{"id":"XMZxpXHyjFRY","executionInfo":{"status":"ok","timestamp":1662430143657,"user_tz":-540,"elapsed":295,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":63,"outputs":[]},{"cell_type":"code","source":["model = models.vgg16(pretrained=True)\n","torch.save(model.state_dict(), 'model_weights.pth')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":161,"referenced_widgets":["1bcf7940909a4a659353451a51e9acb2","1d1d03272c834457af4998123a13e1ba","c6cef582adac458c845e783a3edb3f70","e46566b2c4ce4724b3d129ba540ba556","232089716d2d4ecb99d41c610d7b8ae6","858b29ed86a343e0a28152eecbb770bc","5b06b77a9a244175872d5c87249f49ae","3b940d8ba70342a592638c70dbb8e08b","ac3de85019214e0185a187d92d51631b","b20ddbe80efc4f9c8d44a1c098e8e0cf","464dc6fa6a2547298c65c1bd54d78343"]},"id":"wCiJrKlVjHE6","executionInfo":{"status":"ok","timestamp":1662430154754,"user_tz":-540,"elapsed":9906,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"eff7b0ef-4ebc-467b-a20d-0e6dedf23a95"},"execution_count":64,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/torchvision/models/_utils.py:209: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.\n","  f\"The parameter '{pretrained_param}' is deprecated since 0.13 and will be removed in 0.15, \"\n","/usr/local/lib/python3.7/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.\n","  warnings.warn(msg)\n","Downloading: \"https://download.pytorch.org/models/vgg16-397923af.pth\" to /root/.cache/torch/hub/checkpoints/vgg16-397923af.pth\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0.00/528M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1bcf7940909a4a659353451a51e9acb2"}},"metadata":{}}]},{"cell_type":"code","source":["model = models.vgg16()\n","model.load_state_dict(torch.load('model_weights.pth'))\n","model.eval()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DX2rXqRmjIOp","executionInfo":{"status":"ok","timestamp":1662430158959,"user_tz":-540,"elapsed":4213,"user":{"displayName":"박연호","userId":"00863689034239584697"}},"outputId":"4367719f-d171-4a4d-9b31-8fda7341b9f9"},"execution_count":65,"outputs":[{"output_type":"execute_result","data":{"text/plain":["VGG(\n","  (features): Sequential(\n","    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (1): ReLU(inplace=True)\n","    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (3): ReLU(inplace=True)\n","    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (6): ReLU(inplace=True)\n","    (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (8): ReLU(inplace=True)\n","    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (11): ReLU(inplace=True)\n","    (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (13): ReLU(inplace=True)\n","    (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (15): ReLU(inplace=True)\n","    (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (18): ReLU(inplace=True)\n","    (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (20): ReLU(inplace=True)\n","    (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (22): ReLU(inplace=True)\n","    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (25): ReLU(inplace=True)\n","    (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (27): ReLU(inplace=True)\n","    (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (29): ReLU(inplace=True)\n","    (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","  )\n","  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))\n","  (classifier): Sequential(\n","    (0): Linear(in_features=25088, out_features=4096, bias=True)\n","    (1): ReLU(inplace=True)\n","    (2): Dropout(p=0.5, inplace=False)\n","    (3): Linear(in_features=4096, out_features=4096, bias=True)\n","    (4): ReLU(inplace=True)\n","    (5): Dropout(p=0.5, inplace=False)\n","    (6): Linear(in_features=4096, out_features=1000, bias=True)\n","  )\n",")"]},"metadata":{},"execution_count":65}]},{"cell_type":"code","source":["torch.save(model, 'model.pth')"],"metadata":{"id":"fzhEV6UzjKuh","executionInfo":{"status":"ok","timestamp":1662430161197,"user_tz":-540,"elapsed":2246,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":66,"outputs":[]},{"cell_type":"code","source":["model = torch.load('model.pth')"],"metadata":{"id":"8_H-mwA8jMO5","executionInfo":{"status":"ok","timestamp":1662430163253,"user_tz":-540,"elapsed":481,"user":{"displayName":"박연호","userId":"00863689034239584697"}}},"execution_count":67,"outputs":[]}]}